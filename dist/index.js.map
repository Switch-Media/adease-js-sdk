{"version":3,"sources":["webpack://adease/webpack/universalModuleDefinition","webpack://adease/webpack/bootstrap","webpack://adease/external \"immutable\"","webpack://adease/./src/Util.ts","webpack://adease/./src/Configuration.ts","webpack://adease/external \"query-string\"","webpack://adease/(webpack)/buildin/global.js","webpack://adease/./src/Adease.ts","webpack://adease/./src/index.ts"],"names":["root","factory","exports","module","require","define","amd","self","this","__WEBPACK_EXTERNAL_MODULE__0__","__WEBPACK_EXTERNAL_MODULE__3__","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","r","value","n","__esModule","object","property","prototype","hasOwnProperty","p","s","round","Math","EventType","immutable_1","NonLinearEvents","CreativeView","AcceptInvitation","AdExpand","Minimize","Close","OverlayViewDuration","LinearEvents","Start","Impression","FirstQuartile","MidPoint","ThirdQuartile","Complete","AcceptInvitationLinear","TimeSpentViewing","Progress","CloseLinear","PlayerEvents","Mute","Unmute","Pause","Resume","Rewind","Skip","PlayerExpand","PlayerCollapse","Configuration","config","_classCallCheck","trackingURLs","concat","toList","_this","filter","tURL","kind","Clickthrough","reduce","ads","findIndex","ad","startTime","List","t","adID","endTime","id","trackingUrls","clickThroughs","push","parsedConfiguration","parseFromObject","Error","json","media","map","convertTrackingURLJSON","streams","renditions","obj","url","isLive","live","_","Number","starttime","endtime","event","default","g","Function","eval","e","window","QueryString","Configuration_1","Util_1","Adease","serverURL","liveQueryParams","version","sentBeacons","Set","lastTimePosition","NaN","reset","fetch","then","res","fromJSON","ensureSetup","getConfig","toJS","timeMs","_this2","sendBeacons","tag","_this3","ownerPosition","indexOf","extractIdentifier","parts","split","length","trim","Promise","resolve","slice","includes","currentCuepointID","retrieveLiveAdBreakTracking","assign","pushTrackingURLs","evt","assetTimeMs","getAds","sort","a","b","position","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","Symbol","iterator","next","done","err","return","getAdBreaks","streamTimeMs","add","allAds","previousAdsDuration","inProgressAdsDuration","cuepointID","queryString","stringify","_typeof","data","time","eventType","_this4","kindFilter","timeFilter","global","debug","getBeaconsForRange","ps","mode","all","start","end","getTrackingURLs","clear","Adease_1"],"mappings":"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","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"immutable\"), require(\"query-string\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"adease\", [\"immutable\", \"query-string\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"adease\"] = factory(require(\"immutable\"), require(\"query-string\"));\n\telse\n\t\troot[\"adease\"] = factory(root[\"immutable\"], root[\"query-string\"]);\n})(typeof self !== 'undefined' ? self : this, function(__WEBPACK_EXTERNAL_MODULE__0__, __WEBPACK_EXTERNAL_MODULE__3__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 6);\n","module.exports = __WEBPACK_EXTERNAL_MODULE__0__;","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * Rounds to two decimal places.\n * @param n number to round\n */\nfunction round(n) {\n    return Math.round(n * 100) / 100;\n}\nexports.round = round;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst immutable_1 = require(\"immutable\");\nvar EventType;\n(function (EventType) {\n    // Basic metrics\n    EventType[\"Impression\"] = \"impression\";\n    EventType[\"Clickthrough\"] = \"clickthrough\";\n    EventType[\"Stream\"] = \"stream\";\n    EventType[\"Fullscreen\"] = \"fullscreen\";\n    EventType[\"ExitFullscreen\"] = \"exitFullscreen\";\n    EventType[\"OtherAdInteraction\"] = \"otherAdInteraction\";\n    // Linear Ad Metrics\n    EventType[\"Start\"] = \"start\";\n    EventType[\"FirstQuartile\"] = \"firstQuartile\";\n    EventType[\"MidPoint\"] = \"midpoint\";\n    EventType[\"ThirdQuartile\"] = \"thirdQuartile\";\n    EventType[\"Complete\"] = \"complete\";\n    EventType[\"AcceptInvitationLinear\"] = \"acceptInvitationLinear\";\n    EventType[\"TimeSpentViewing\"] = \"timeSpentViewing\";\n    EventType[\"Progress\"] = \"progress\";\n    EventType[\"CloseLinear\"] = \"closeLinear\";\n    // Nonlinear Ad Metrics\n    EventType[\"CreativeView\"] = \"creativeView\";\n    EventType[\"AcceptInvitation\"] = \"acceptInvitation\";\n    EventType[\"AdExpand\"] = \"adExpand\";\n    EventType[\"AdCollapse\"] = \"adCollapse\";\n    EventType[\"Minimize\"] = \"minimize\";\n    EventType[\"Close\"] = \"close\";\n    EventType[\"OverlayViewDuration\"] = \"overlayViewDuration\";\n    // Player Operation Metrics (for both Linear and Nonlinear ads)\n    EventType[\"Mute\"] = \"mute\";\n    EventType[\"Unmute\"] = \"unmute\";\n    EventType[\"Pause\"] = \"pause\";\n    EventType[\"Resume\"] = \"resume\";\n    EventType[\"Rewind\"] = \"rewind\";\n    EventType[\"Skip\"] = \"skip\";\n    EventType[\"PlayerExpand\"] = \"playerExpand\";\n    EventType[\"PlayerCollapse\"] = \"playerCollapse\";\n})(EventType = exports.EventType || (exports.EventType = {}));\nexports.NonLinearEvents = [\n    EventType.CreativeView,\n    EventType.AcceptInvitation,\n    EventType.AdExpand,\n    EventType.Minimize,\n    EventType.Close,\n    EventType.OverlayViewDuration\n];\nexports.LinearEvents = [\n    EventType.Start,\n    EventType.Impression,\n    EventType.FirstQuartile,\n    EventType.MidPoint,\n    EventType.ThirdQuartile,\n    EventType.Complete,\n    EventType.AcceptInvitationLinear,\n    EventType.TimeSpentViewing,\n    EventType.Progress,\n    EventType.CloseLinear\n];\nexports.PlayerEvents = [\n    EventType.Mute,\n    EventType.Unmute,\n    EventType.Pause,\n    EventType.Resume,\n    EventType.Rewind,\n    EventType.Skip,\n    EventType.PlayerExpand,\n    EventType.PlayerCollapse\n];\n/**\n * @internal\n */\nclass Configuration {\n    constructor(config) {\n        this.config = config;\n    }\n    static fromJSON(config) {\n        const parsedConfiguration = Configuration.parseFromObject(config);\n        if (parsedConfiguration === null) {\n            throw new Error(\"error parsing configuration\");\n        }\n        return new Configuration(parsedConfiguration);\n    }\n    static parseFromObject(json) {\n        if (!(json && json.media && json.media.trackingUrls)) {\n            return null;\n        }\n        return {\n            trackingURLs: immutable_1.List(json.media.trackingUrls.map(Configuration.convertTrackingURLJSON)),\n            streams: immutable_1.List(json.media.renditions.map(obj => ({\n                url: obj.url\n            }))),\n            isLive: json.media.live || false\n        };\n    }\n    pushTrackingURLs(trackingURLs) {\n        this.config.trackingURLs = this.config.trackingURLs\n            .concat(trackingURLs)\n            .toList();\n    }\n    getAdBreaks() {\n        if (!this.config || !this.config.trackingURLs) {\n            return immutable_1.List();\n        }\n        return this.config.trackingURLs\n            .filter(tURL => (tURL ? tURL.kind === EventType.Clickthrough : false))\n            .reduce((ads, tURL) => {\n            // Try to find an existing ad with this start time.\n            if (ads.findIndex(ad => (ad ? ad.startTime === tURL.startTime : false)) !== -1) {\n                return ads;\n            }\n            // Get the tracking URLs for this ad.\n            const trackingURLs = immutable_1.List(this.config.trackingURLs.filter(t => t\n                ? t.adID === tURL.adID &&\n                    t.startTime >= tURL.startTime &&\n                    t.endTime <= tURL.endTime\n                : false));\n            const ad = {\n                id: tURL.adID,\n                startTime: tURL.startTime,\n                endTime: tURL.endTime,\n                trackingUrls: trackingURLs,\n                clickThroughs: immutable_1.List(trackingURLs.filter(tURL => (tURL ? tURL.kind === EventType.Clickthrough : false)))\n            };\n            return ads.push(ad);\n        }, immutable_1.List());\n    }\n    static getDurationFromClickthrough(trackingURLs) {\n        return trackingURLs\n            .filter(tURL => (tURL ? tURL.kind === EventType.Clickthrough : false))\n            .reduce((_, tURL) => (tURL ? tURL.endTime - tURL.startTime : 0), 0);\n    }\n    static convertTrackingURLJSON(obj) {\n        return {\n            url: obj.url,\n            startTime: Number(obj.starttime),\n            endTime: Number(obj.endtime),\n            kind: obj.event,\n            adID: obj.adID\n        };\n    }\n    getConfig() {\n        return this.config;\n    }\n    getTrackingURLs() {\n        return this.config.trackingURLs;\n    }\n}\nexports.default = Configuration;\n","module.exports = __WEBPACK_EXTERNAL_MODULE__3__;","var g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1, eval)(\"this\");\r\n} catch (e) {\r\n\t// This works if the window reference is available\r\n\tif (typeof window === \"object\") g = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst immutable_1 = require(\"immutable\");\nconst QueryString = require(\"query-string\");\nconst Configuration_1 = require(\"./Configuration\");\nconst Util_1 = require(\"./Util\");\n/**\n * The adease class essentially provides a wrapper around a configuration object.\n * The configuration object contains all of the information regarding where in a stream\n * the ads have been inserted.\n *\n * This class has methods both to query what ads have been inserted where, as well\n * as triggering analytics based on time updates and user initiated actions.\n *\n * Internal state is kept to track what beacons have been sent, and what the last time\n * update was. Whenever configuration is provided this internal state is reset.\n * If this internal state needs to be preserved, then a new instance should be created\n * instead.\n *\n * *NOTE:* All methods except `configureFromURL` and `configureFromObject` will\n * throw an exception if the class has not been provided configuration.  Your\n * code should ensure that the class has been setup before calling any methods;\n * a proxy pattern can work well here. This design choice has been made\n * to avoid silently failing, to increase development/debugging speed.\n */\nclass Adease {\n    constructor(serverURL, liveQueryParams) {\n        this.version = VERSION;\n        this.serverURL = serverURL || \"\";\n        this.liveQueryParams = liveQueryParams || {};\n        this.sentBeacons = immutable_1.Set();\n        this.lastTimePosition = NaN;\n    }\n    /**\n     * Downloads adease configuration from a URL, returning a promise\n     * that resolves with undefined when done.\n     * @param url string\n     * @return Promise<void>\n     */\n    configureFromURL(url) {\n        this.reset();\n        return fetch(url)\n            .then(res => res.json())\n            .then(Configuration_1.default.fromJSON)\n            .then(_ => (this.config = _))\n            .then(() => undefined);\n    }\n    /**\n     * Configures the class from an object.\n     * @param url string\n     * @return Promise<void>\n     */\n    configureFromObject(object) {\n        this.reset();\n        this.config = Configuration_1.default.fromJSON(object);\n    }\n    getStreams() {\n        this.ensureSetup();\n        return this.config.getConfig().streams.toJS();\n    }\n    /**\n     * Notify that a time update (position in the stream) has occured. This may fire off beacons.\n     * Returns a promise that resolves once all underlying network requests have completed.\n     *\n     * @param timeMs number Time in milliseconds.\n     */\n    notifyTimeUpdate(timeMs) {\n        this.ensureSetup();\n        if (this.lastTimePosition === NaN) {\n            this.lastTimePosition = 0;\n        }\n        return this.sendBeacons(timeMs)\n            .then(() => (this.lastTimePosition = timeMs))\n            .then(() => undefined);\n    }\n    /**\n     * For live only.\n     *\n     * Call when an ID3 tag is detected in the metadata track.\n     *\n     * @param tag The string tag of the event;\n     * @param timeMs The time in milliseconds that the event appears in the stream.\n     * @returns A promise that resolves once all undelying actions have completed.\n     */\n    notifyID3Event(tag, timeMs) {\n        const owner = \"switch.tv\";\n        const ownerPosition = tag.indexOf(owner);\n        const extractIdentifier = (tag) => {\n            const parts = tag.split(\":\");\n            return parts.length > 0 ? parts[1].trim() : \"\";\n        };\n        if (ownerPosition === -1) {\n            return Promise.resolve();\n        }\n        tag = tag.slice(ownerPosition + owner.length);\n        if (tag.includes(\"CUE:\")) {\n            const id = extractIdentifier(tag);\n            this.currentCuepointID = id;\n        }\n        else if (tag.includes(\"ADSTART:\")) {\n            const adID = extractIdentifier(tag);\n            return (this.retrieveLiveAdBreakTracking(this.currentCuepointID, adID)\n                // Offset each tracking URL by the time the ad break appears in the stream.\n                .then(_ => _.map(tURL => (tURL\n                ? Object.assign({}, tURL, {\n                    startTime: tURL.startTime + timeMs,\n                    endTime: tURL.endTime + timeMs\n                })\n                : tURL)).toList())\n                .then(_ => this.config.pushTrackingURLs(_)));\n        }\n        else if (tag.includes(\"ADEND:\")) {\n            // Currently ignored.\n        }\n        return Promise.resolve();\n    }\n    /**\n     * Notify that a player event has occured, such as resume, pause, mute or unmute.\n     * This will send the appropriate beacons for that event.\n     *\n     * @param evt The type of event, such as \"mute\" or \"pause\".\n     * @param timeMs\n     */\n    notifyPlayerEvent(evt, timeMs) {\n        return this.sendBeacons(timeMs, evt);\n    }\n    /**\n     * Since inserting ads into a stream changes the duration, it can be useful to translate\n     * between the original time of the asset and the corresponding time in the loaded stream.\n     * This method returns the time in the stream that a position in the original asset corresponds to.\n     *\n     * For example, 5 seconds into the original asset would be 35 seconds in the loaded stream\n     * if a 30 second pre roll has been inserted.\n     *\n     * @param assetTimeMs Returns the real stream time.\n     */\n    getStreamTime(assetTimeMs) {\n        this.ensureSetup();\n        // Calculate the true start times of each ad.\n        const ads = this.getAds().sort((a, b) => {\n            if (a.startTime < b.startTime) {\n                return -1;\n            }\n            if (a.startTime > b.startTime) {\n                return 1;\n            }\n            return 0;\n        });\n        let position = assetTimeMs;\n        for (const ad of ads) {\n            // Position is in the middle of an ad. Move to end.\n            if (position >= ad.startTime) {\n                position += ad.endTime;\n            }\n        }\n        return Util_1.round(position);\n    }\n    /**\n     * Returns the ads.\n     */\n    getAds() {\n        this.ensureSetup();\n        return this.config.getAdBreaks().toJS();\n    }\n    /**\n     * Returns the ads that are present at a given moment. In practice this\n     * will only ever return either an empty list, or a list with one element.\n     * It is theoretically possible for more than one ad to be returned,\n     * however this makes no practical sense.\n     *\n     * @param timeMs Time in milliseconds.\n     */\n    getAdsAtTime(timeMs) {\n        this.ensureSetup();\n        return this.config\n            .getAdBreaks()\n            .filter(ad => (ad ? ad.startTime <= timeMs && ad.endTime >= timeMs : false))\n            .toJS();\n    }\n    /**\n     * This is the inverse of `getStreamTime`. It returns the time in an asset\n     * that the loaded stream time corresponds to. For example, if the time 35 seconds is\n     * given, then 5 seconds will be returned if a 30 second pre roll has been inserted.\n     *\n     * @param streamTimeMs number Time in milliseconds.\n     * @returns number Time in milliseconds.\n     */\n    getAssetTime(streamTimeMs) {\n        this.ensureSetup();\n        const add = (a, b) => a + b;\n        // Find the ads before the given time.\n        const allAds = this.config\n            .getAdBreaks()\n            .filter(ad => (ad ? ad.startTime < streamTimeMs : false));\n        const previousAdsDuration = allAds\n            .filter(ad => (ad ? ad.endTime <= streamTimeMs : false))\n            .map(ad => (ad ? ad.endTime - ad.startTime : false))\n            .reduce(add, 0);\n        const inProgressAdsDuration = allAds\n            .filter(ad => (ad ? ad.endTime > streamTimeMs : false))\n            .map(ad => (ad ? streamTimeMs - ad.startTime : ad))\n            .reduce(add, 0);\n        return Util_1.round(streamTimeMs - (previousAdsDuration + inProgressAdsDuration));\n    }\n    retrieveLiveAdBreakTracking(cuepointID, adID) {\n        const queryString = QueryString.stringify(Object.assign({}, this.liveQueryParams, {\n            cuepointID,\n            adID\n        }));\n        return fetch(this.serverURL + \"/stream/tracking?\" + queryString)\n            .then(r => r.json())\n            .then(json => {\n            // Assert that the data contains an array.\n            if (json &&\n                typeof json.data === \"object\" &&\n                json.data.hasOwnProperty(\"length\")) {\n                return immutable_1.List(json.data.map(Configuration_1.default.convertTrackingURLJSON));\n            }\n            return immutable_1.List();\n        });\n    }\n    /**\n     * @return A promise that resolves once all beacons are sent.\n     */\n    sendBeacons(time, eventType) {\n        // If eventType is provided, then send those beacons.\n        // Otherwise send the linear event beacons.\n        const kindFilter = () => {\n            if (eventType != null) {\n                return (tURL) => tURL ? tURL.kind === eventType : false;\n            }\n            return (tURL) => tURL ? Configuration_1.LinearEvents.includes(tURL.kind) : false;\n        };\n        const timeFilter = (tURL) => {\n            if (!tURL) {\n                return false;\n            }\n            if (Configuration_1.LinearEvents.includes(tURL.kind)) {\n                return tURL.startTime < time && tURL.startTime > this.lastTimePosition;\n            }\n            return tURL.startTime <= time && tURL.endTime > time;\n        };\n        if (global.debug) {\n            const ps = this.getBeaconsForRange(this.lastTimePosition, time)\n                .filter(kindFilter())\n                .filter(timeFilter);\n        }\n        const ps = this.getBeaconsForRange(this.lastTimePosition, time)\n            .filter(kindFilter())\n            .filter(timeFilter)\n            .map(tURL => {\n            if (!tURL) {\n                return Promise.resolve();\n            }\n            if (tURL && this.sentBeacons.includes(tURL)) {\n                return Promise.resolve();\n            }\n            this.sentBeacons = this.sentBeacons.add(tURL);\n            return fetch(tURL.url, {\n                mode: \"no-cors\"\n            }).then(() => undefined);\n        })\n            .toJS();\n        return Promise.all(ps).then(() => undefined);\n    }\n    getBeaconsForRange(start, end) {\n        return this.config\n            .getTrackingURLs()\n            .filter(tURL => (tURL ? tURL.startTime <= end && tURL.endTime >= start : false))\n            .toList();\n    }\n    ensureSetup() {\n        if (!this.config) {\n            throw new Error(\"Adease not setup, but method called\");\n        }\n    }\n    /**\n     * Resets the internal state of the object so that it can be reused.\n     */\n    reset() {\n        this.sentBeacons = this.sentBeacons.clear();\n    }\n}\nexports.default = Adease;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst Adease_1 = require(\"./Adease\");\nexports.Adease = Adease_1.default;\n"],"sourceRoot":""}