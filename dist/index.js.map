{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap bf04612076d28fa1f9f9","webpack:///./src/index.ts","webpack:///./src/Adease.ts","webpack:///external \"immutable\"","webpack:///./src/Configuration.ts","webpack:///./src/Util.ts"],"names":["Object","defineProperty","exports","value","Adease_1","require","Adease","default","immutable_1","Configuration_1","Util_1","sentBeacons","Set","lastTimePosition","NaN","url","reset","fetch","then","res","json","fromJSON","config","_","undefined","object","ensureSetup","getConfig","streams","timeMs","sendBeacons","assetTimeMs","ads","getAds","sort","a","b","startTime","position","ad","endTime","round","getAdBreaks","filter","streamTimeMs","add","allAds","previousAdsDuration","map","reduce","inProgressAdsDuration","time","ps","getBeaconsForRange","LinearEvents","includes","tURL","kind","Promise","resolve","mode","all","start","end","getTrackingURLs","Error","clear","EventType","NonLinearEvents","CreativeView","AcceptInvitation","AdExpand","Minimize","Close","OverlayViewDuration","Start","Impression","FirstQuartile","MidPoint","ThirdQuartile","Complete","AcceptInvitationLinear","TimeSpentViewing","Progress","CloseLinear","PlayerEvents","Mute","Unmute","Pause","Resume","Rewind","Skip","PlayerExpand","PlayerCollapse","Configuration","trackingURLs","Clickthrough","findIndex","t","adID","id","trackingUrls","clickThroughs","concat","parsedConfiguration","parseFromObject","media","obj","Number","starttime","endtime","event","renditions","n","Math"],"mappings":"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","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"immutable\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"immutable\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"adease\"] = factory(require(\"immutable\"));\n\telse\n\t\troot[\"adease\"] = factory(root[\"immutable\"]);\n})(typeof self !== 'undefined' ? self : this, function(__WEBPACK_EXTERNAL_MODULE_2__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap bf04612076d28fa1f9f9","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst Adease_1 = require(\"./Adease\");\nexports.Adease = Adease_1.default;\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.ts","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst immutable_1 = require(\"immutable\");\nconst Configuration_1 = require(\"./Configuration\");\nconst Util_1 = require(\"./Util\");\nclass Adease {\n    constructor() {\n        this.sentBeacons = immutable_1.Set();\n        this.lastTimePosition = NaN;\n    }\n    /**\n     * Downloads adease configuration from a URL, returning a promise\n     * that resolves with undefined when done.\n     * @param url string\n     * @return Promise<void>\n     */\n    configureFromURL(url) {\n        this.reset();\n        return fetch(url)\n            .then(res => res.json())\n            .then(Configuration_1.default.fromJSON)\n            .then(_ => (this.config = _))\n            .then(() => undefined);\n    }\n    /**\n     * Downloads adease configuration from a URL, returning a promise\n     * that resolves with undefined when done.\n     * @param url string\n     * @return Promise<void>\n     */\n    configureFromObject(object) {\n        this.reset();\n        this.config = Configuration_1.default.fromJSON(object);\n    }\n    getStreams() {\n        this.ensureSetup();\n        return this.config.getConfig().streams;\n    }\n    /**\n     * Notify adease that a time update has occured. This may fire off beacons.\n     * Returns a promise that resolves once all underlying actions have completed.\n     *\n     * @param timeMs number Time in milliseconds.\n     */\n    notifyTimeUpdate(timeMs) {\n        this.ensureSetup();\n        if (this.lastTimePosition === NaN) {\n            this.lastTimePosition = 0;\n        }\n        return this.sendBeacons(timeMs)\n            .then(() => (this.lastTimePosition = timeMs))\n            .then(() => undefined);\n    }\n    /**\n     *\n     * @param assetTimeMs Returns the real stream time.\n     */\n    getStreamTime(assetTimeMs) {\n        this.ensureSetup();\n        // Calculate the true start times of each ad.\n        const ads = this.getAds().sort((a, b) => {\n            if (a.startTime < b.startTime) {\n                return -1;\n            }\n            if (a.startTime > b.startTime) {\n                return 1;\n            }\n            return 0;\n        });\n        let position = assetTimeMs;\n        for (const ad of ads) {\n            // Position is in the middle of an ad. Move to end.\n            if (position >= ad.startTime) {\n                position += ad.endTime;\n            }\n        }\n        return Util_1.round(position);\n    }\n    /**\n     * Returns the ads.\n     */\n    getAds() {\n        this.ensureSetup();\n        return this.config.getAdBreaks();\n    }\n    /**\n     *\n     * @param timeMs Time in milliseconds.\n     */\n    getAdsAtTime(timeMs) {\n        this.ensureSetup();\n        return this.config.getAdBreaks().filter(ad => ad.startTime <= timeMs && ad.endTime >= timeMs);\n    }\n    /**\n     *\n     * @param streamTimeMs number Time in milliseconds.\n     * @returns number Time in milliseconds.\n     */\n    getAssetTime(streamTimeMs) {\n        this.ensureSetup();\n        const add = (a, b) => a + b;\n        // Find the ads before the given time.\n        const allAds = this.config\n            .getAdBreaks()\n            .filter(ad => ad.startTime < streamTimeMs);\n        const previousAdsDuration = allAds\n            .filter(ad => ad.endTime <= streamTimeMs)\n            .map(ad => ad.endTime - ad.startTime)\n            .reduce(add, 0);\n        const inProgressAdsDuration = allAds\n            .filter(ad => ad.endTime > streamTimeMs)\n            .map(ad => streamTimeMs - ad.startTime)\n            .reduce(add, 0);\n        return Util_1.round(streamTimeMs - (previousAdsDuration + inProgressAdsDuration));\n    }\n    /**\n     * @return A promise that resolves once all beacons are sent.\n     */\n    sendBeacons(time) {\n        const ps = this.getBeaconsForRange(this.lastTimePosition, time)\n            .filter(tURL => Configuration_1.LinearEvents.includes(tURL.kind))\n            .filter(tURL => tURL.startTime < time && tURL.startTime > this.lastTimePosition)\n            .map(tURL => {\n            if (this.sentBeacons.includes(tURL)) {\n                return Promise.resolve();\n            }\n            this.sentBeacons = this.sentBeacons.add(tURL);\n            return fetch(tURL.url, {\n                mode: \"no-cors\"\n            }).then(() => undefined);\n        });\n        return Promise.all(ps).then(() => undefined);\n    }\n    getBeaconsForRange(start, end) {\n        return this.config\n            .getTrackingURLs()\n            .filter(tURL => tURL.startTime <= end && tURL.endTime >= start);\n    }\n    ensureSetup() {\n        if (!this.config) {\n            throw new Error(\"Adease not setup, but method called\");\n        }\n    }\n    /**\n     * Resets the internal state of the object so that it can be reused.\n     */\n    reset() {\n        this.sentBeacons = this.sentBeacons.clear();\n    }\n}\nexports.default = Adease;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Adease.ts","module.exports = __WEBPACK_EXTERNAL_MODULE_2__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"immutable\"\n// module id = 2\n// module chunks = 0","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar EventType;\n(function (EventType) {\n    // Basic metrics\n    EventType[\"Impression\"] = \"impression\";\n    EventType[\"Clickthrough\"] = \"clickthrough\";\n    EventType[\"Stream\"] = \"stream\";\n    EventType[\"Fullscreen\"] = \"fullscreen\";\n    EventType[\"ExitFullscreen\"] = \"exitFullscreen\";\n    EventType[\"OtherAdInteraction\"] = \"otherAdInteraction\";\n    // Linear Ad Metrics\n    EventType[\"Start\"] = \"start\";\n    EventType[\"FirstQuartile\"] = \"firstQuartile\";\n    EventType[\"MidPoint\"] = \"midpoint\";\n    EventType[\"ThirdQuartile\"] = \"thirdQuartile\";\n    EventType[\"Complete\"] = \"complete\";\n    EventType[\"AcceptInvitationLinear\"] = \"acceptInvitationLinear\";\n    EventType[\"TimeSpentViewing\"] = \"timeSpentViewing\";\n    EventType[\"Progress\"] = \"progress\";\n    EventType[\"CloseLinear\"] = \"closeLinear\";\n    // Nonlinear Ad Metrics\n    EventType[\"CreativeView\"] = \"creativeView\";\n    EventType[\"AcceptInvitation\"] = \"acceptInvitation\";\n    EventType[\"AdExpand\"] = \"adExpand\";\n    EventType[\"AdCollapse\"] = \"adCollapse\";\n    EventType[\"Minimize\"] = \"minimize\";\n    EventType[\"Close\"] = \"close\";\n    EventType[\"OverlayViewDuration\"] = \"overlayViewDuration\";\n    // Player Operation Metrics (for both Linear and Nonlinear ads)\n    EventType[\"Mute\"] = \"mute\";\n    EventType[\"Unmute\"] = \"unmute\";\n    EventType[\"Pause\"] = \"pause\";\n    EventType[\"Resume\"] = \"resume\";\n    EventType[\"Rewind\"] = \"rewind\";\n    EventType[\"Skip\"] = \"skip\";\n    EventType[\"PlayerExpand\"] = \"playerExpand\";\n    EventType[\"PlayerCollapse\"] = \"playerCollapse\";\n})(EventType = exports.EventType || (exports.EventType = {}));\nexports.NonLinearEvents = [\n    EventType.CreativeView,\n    EventType.AcceptInvitation,\n    EventType.AdExpand,\n    EventType.Minimize,\n    EventType.Close,\n    EventType.OverlayViewDuration\n];\nexports.LinearEvents = [\n    EventType.Start,\n    EventType.Impression,\n    EventType.FirstQuartile,\n    EventType.MidPoint,\n    EventType.ThirdQuartile,\n    EventType.Complete,\n    EventType.AcceptInvitationLinear,\n    EventType.TimeSpentViewing,\n    EventType.Progress,\n    EventType.CloseLinear\n];\nexports.PlayerEvents = [\n    EventType.Mute,\n    EventType.Unmute,\n    EventType.Pause,\n    EventType.Resume,\n    EventType.Rewind,\n    EventType.Skip,\n    EventType.PlayerExpand,\n    EventType.PlayerCollapse\n];\n/**\n * @internal\n */\nclass Configuration {\n    constructor(config) {\n        this.config = config;\n    }\n    static fromJSON(config) {\n        const parsedConfiguration = Configuration.parseFromObject(config);\n        if (parsedConfiguration === null) {\n            throw new Error(\"error parsing configuration\");\n        }\n        return new Configuration(parsedConfiguration);\n    }\n    static parseFromObject(json) {\n        if (!(json && json.media && json.media.trackingUrls)) {\n            return null;\n        }\n        return {\n            trackingURLs: json.media.trackingUrls.map(obj => ({\n                url: obj.url,\n                startTime: Number(obj.starttime),\n                endTime: Number(obj.endtime),\n                kind: obj.event,\n                adID: obj.adID\n            })),\n            streams: json.media.renditions.map(obj => ({\n                url: obj.url\n            }))\n        };\n    }\n    getAdBreaks() {\n        if (!this.config || !this.config.trackingURLs) {\n            return [];\n        }\n        return this.config.trackingURLs\n            .filter(tURL => tURL.kind === EventType.Clickthrough)\n            .reduce((ads, tURL) => {\n            // Try to find an existing ad with this start time.\n            if (ads.findIndex(ad => ad.startTime === tURL.startTime) !== -1) {\n                return ads;\n            }\n            // Get the tracking URLs for this ad.\n            const trackingURLs = this.config.trackingURLs.filter(t => t.adID === tURL.adID &&\n                t.startTime >= tURL.startTime &&\n                t.endTime <= tURL.endTime);\n            const ad = {\n                id: tURL.adID,\n                startTime: tURL.startTime,\n                endTime: tURL.endTime,\n                trackingUrls: trackingURLs,\n                clickThroughs: trackingURLs.filter(tURL => tURL.kind === EventType.Clickthrough),\n            };\n            return ads.concat(ad);\n        }, []);\n    }\n    getConfig() {\n        return this.config;\n    }\n    getTrackingURLs() {\n        return this.config.trackingURLs;\n    }\n}\nexports.default = Configuration;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Configuration.ts","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * Rounds to two decimal places.\n * @param n number to round\n */\nfunction round(n) {\n    return Math.round(n * 100) / 100;\n}\nexports.round = round;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Util.ts"],"sourceRoot":""}